<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English to Hangul Typing</title>
<style>
    #englishInput {
        width: 300px;
        padding: 10px;
        font-size: 16px;
    }
    #hangulInput {
        width: 300px;
        padding: 10px;
        font-size: 16px;
    }
</style>
</head>
<body>

<input type="text" id="englishInput" placeholder="Type in English...">
<input type="text" id="hangulInput" placeholder="Hangul output..." readonly>

<script>
// Hangul mapping object (for English to Hangul conversion)
const hangulMap = {
    'a': 'ㅁ', 'b': 'ㅠ', 'c': 'ㅊ', 'd': 'ㅇ', 'e': 'ㄷ', 'f': 'ㄹ', 'g': 'ㅎ', 'h': 'ㅗ', 'i': 'ㅑ', 'j': 'ㅓ',
    'k': 'ㅏ', 'l': 'ㅣ', 'm': 'ㅡ', 'n': 'ㅜ', 'o': 'ㅐ', 'p': 'ㅔ', 'q': 'ㅂ', 'r': 'ㄱ', 's': 'ㄴ', 't': 'ㅅ',
    'u': 'ㅕ', 'v': 'ㅍ', 'w': 'ㅈ', 'x': 'ㅌ', 'y': 'ㅛ', 'z': 'ㅋ'
};

// Function to compose Hangul syllable based on jamo characters
function composeHangulSyllable(initial, medial, final) {
    return String.fromCharCode((initial * 588) + (medial * 28) + final + 44032);
}

let jamoBuffer = ''; // Buffer to store entered jamos

document.getElementById('englishInput').addEventListener('input', function() {
    const englishInput = this.value.toLowerCase();
    let hangulOutput = '';
    for (let i = 0; i < englishInput.length; i++) {
        const char = englishInput[i];
        // If the character exists in hangulMap, append the corresponding Hangul character
        hangulOutput += hangulMap[char] || char;
    }
    document.getElementById('hangulInput').value = hangulOutput;
});

document.addEventListener('keydown', function(event) {
    if (event.key === ' ') {
        // Spacebar pressed, compose the syllable
        const syllable = composeHangulSyllable(...jamoBuffer.split('').map(jamo => {
            // Convert jamo characters to index values for initial, medial, and final
            switch (jamo) {
                case 'ㄱ':
                    return 0;
                case 'ㄲ':
                    return 1;
                case 'ㄴ':
                    return 2;
                case 'ㄷ':
                    return 3;
                case 'ㄸ':
                    return 4;
                case 'ㄹ':
                    return 5;
                case 'ㅁ':
                    return 6;
                case 'ㅂ':
                    return 7;
                case 'ㅃ':
                    return 8;
                case 'ㅅ':
                    return 9;
                case 'ㅆ':
                    return 10;
                case 'ㅇ':
                    return 11;
                case 'ㅈ':
                    return 12;
                case 'ㅉ':
                    return 13;
                case 'ㅊ':
                    return 14;
                case 'ㅋ':
                    return 15;
                case 'ㅌ':
                    return 16;
                case 'ㅍ':
                    return 17;
                case 'ㅎ':
                    return 18;
                case 'ㅏ':
                    return 0;
                case 'ㅐ':
                    return 1;
                case 'ㅑ':
                    return 2;
                case 'ㅒ':
                    return 3;
                case 'ㅓ':
                    return 4;
                case 'ㅔ':
                    return 5;
                case 'ㅕ':
                    return 6;
                case 'ㅖ':
                    return 7;
                case 'ㅗ':
                    return 8;
                case 'ㅘ':
                    return 9;
                case 'ㅙ':
                    return 10;
                case 'ㅚ':
                    return 11;
                case 'ㅛ':
                    return 12;
                case 'ㅜ':
                    return 13;
                case 'ㅝ':
                    return 14;
                case 'ㅞ':
                    return 15;
                case 'ㅟ':
                    return 16;
                case 'ㅠ':
                    return 17;
                case 'ㅡ':
                    return 18;
                case 'ㅢ':
                    return 19;
                case 'ㅣ':
                    return 20;
                default:
                    return 0; // Use default value for space
            }
        }));
        document.getElementById('hangulInput').value += syllable;
        jamoBuffer = ''; // Clear the buffer
    } else {
        // Add the pressed jamo to the buffer
        if (event.key === 'Backspace') {
            jamoBuffer = jamoBuffer.slice(0, -1); // Remove the last character from the buffer
        } else if (event.key.length === 1) {
            // Allow only single characters as jamos
            jamoBuffer += event.key;
        }
    }
});
</script>

</body>
</html>
