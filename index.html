<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English to Hangul Typing</title>
<style>
    #englishInput {
        width: 300px;
        padding: 10px;
        font-size: 16px;
    }
    #hangulInput {
        width: 300px;
        padding: 10px;
        font-size: 16px;
    }
</style>
</head>
<body>

<input type="text" id="englishInput" placeholder="Type in English...">
<input type="text" id="hangulInput" placeholder="Hangul output..." readonly>

<script>
// Hangul jamo ranges
const initialJamos = ['ㄱ', 'ㄲ', 'ㄴ', 'ㄷ', 'ㄸ', 'ㄹ', 'ㅁ', 'ㅂ', 'ㅃ', 'ㅅ', 'ㅆ', 'ㅇ', 'ㅈ', 'ㅉ', 'ㅊ', 'ㅋ', 'ㅌ', 'ㅍ', 'ㅎ'];
const medialJamos = ['ㅏ', 'ㅐ', 'ㅑ', 'ㅒ', 'ㅓ', 'ㅔ', 'ㅕ', 'ㅖ', 'ㅗ', 'ㅘ', 'ㅙ', 'ㅚ', 'ㅛ', 'ㅜ', 'ㅝ', 'ㅞ', 'ㅟ', 'ㅠ', 'ㅡ', 'ㅢ', 'ㅣ'];
const finalJamos = [' ', 'ㄱ', 'ㄲ', 'ㄳ', 'ㄴ', 'ㄵ', 'ㄶ', 'ㄷ', 'ㄹ', 'ㄺ', 'ㄻ', 'ㄼ', 'ㄽ', 'ㄾ', 'ㄿ', 'ㅀ', 'ㅁ', 'ㅂ', 'ㅄ', 'ㅅ', 'ㅆ', 'ㅇ', 'ㅈ', 'ㅊ', 'ㅋ', 'ㅌ', 'ㅍ', 'ㅎ'];

// Function to compose a Hangul syllable based on initial, medial, and final jamos
function composeHangulSyllable(initial, medial, final) {
    const syllable = (initialJamos.indexOf(initial) * 21 * 28) + (medialJamos.indexOf(medial) * 28) + finalJamos.indexOf(final) + 44032;
    return String.fromCharCode(syllable);
}

let jamoBuffer = ''; // Buffer to store entered jamos

document.getElementById('englishInput').addEventListener('input', function() {
    const englishInput = this.value.toLowerCase();
    let hangulOutput = '';
    for (let i = 0; i < englishInput.length; i++) {
        const char = englishInput[i];
        // If the character exists in hangulMap, append the corresponding Hangul character
        hangulOutput += hangulMap[char] || char;
    }
    document.getElementById('hangulInput').value = hangulOutput;
});

document.addEventListener('keydown', function(event) {
    if (event.key === ' ') {
        // Spacebar pressed, compose the syllable
        const syllable = composeHangulSyllable(...jamoBuffer.split(''));
        document.getElementById('hangulInput').value += syllable;
        jamoBuffer = ''; // Clear the buffer
    } else {
        // Add the pressed jamo to the buffer
        if (initialJamos.includes(event.key) || medialJamos.includes(event.key) || finalJamos.includes(event.key)) {
            jamoBuffer += event.key;
        }
    }
});
</script>

</body>
</html>
