<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English to Hangul Typing</title>
<style>
    #englishInput, #hangulInput {
        width: 300px;
        padding: 10px;
        font-size: 16px;
    }
    #hangulInput {
        margin-top: 8px;
        background: #f0f0f0;
    }
</style>
</head>
<body>

<input type="text" id="englishInput" placeholder="Type in English...">
<input type="text" id="hangulInput" placeholder="Hangul output..." readonly>

<script>
function composeHangulSyllable(initial, medial, final) {
    if (initial < 0 || medial < 0) return ''; // Failsafe for incomplete input
    if (final < 0) final = 0; // Handle non-final entries
    return String.fromCharCode((initial * 588) + (medial * 28) + final + 44032);
}

// Romanization to Jamo mappings (simplified for example purposes)
const romToJamoMap = {
    'g': 'ㄱ', 'kk': 'ㄲ', 'n': 'ㄴ', 'd': 'ㄷ', 'tt': 'ㄸ', 'l': 'ㄹ', 'm': 'ㅁ', 'b': 'ㅂ', 'pp': 'ㅃ',
    's': 'ㅅ', 'ss': 'ㅆ', 'ng': 'ㅇ', 'j': 'ㅈ', 'jj': 'ㅉ', 'ch': 'ㅊ', 'k': 'ㅋ', 't': 'ㅌ', 'p': 'ㅍ', 'h': 'ㅎ',
    'a': 'ㅏ', 'ae': 'ㅐ', 'ya': 'ㅑ', 'yae': 'ㅒ', 'eo': 'ㅓ', 'e': 'ㅔ', 'yeo': 'ㅕ', 'ye': 'ㅖ',
    'o': 'ㅗ', 'wa': 'ㅘ', 'wae': 'ㅙ', 'oe': 'ㅚ', 'yo': 'ㅛ',
    'u': 'ㅜ', 'wo': 'ㅝ', 'we': 'ㅞ', 'wi': 'ㅟ', 'yu': 'ㅠ', 'eu': 'ㅡ', 'ui': 'ㅢ', 'i': 'ㅣ'
};

document.getElementById('englishInput').addEventListener('input', function() {
    const englishInput = this.value.toLowerCase();
    let hangulOutput = '';
    let buffer = '';
    for (let char of englishInput) {
        if (char.match(/[a-z]/)) {
            buffer += char;
            if (romToJamoMap[buffer]) {
                hangulOutput += romToJamoMap[buffer];
                buffer = '';
            }
        } else if (char === ' ') {
            // Space indicates finalizing the current buffer as a syllable
            document.getElementById('hangulInput').value += hangulOutput;
            hangulOutput = '';
        } else {
            buffer = ''; // Reset for non-match
        }
    }
    this.value = buffer; // retain incomplete buffer in input
});

document.getElementById('englishInput').addEventListener('keydown', function(event) {
    if (event.key === ' ') {
        event.preventDefault(); // Prevent space from being added
        let jamos = document.getElementById('hangulInput').value;
        if (jamos.length >= 2) {
            // Assuming a very basic extraction of initial, medial, and possibly final
            const initialIdx = 0;
            const medialIdx = 1;
            const finalIdx = 2;
            let initial = initialIdx < jamos.length ? initialJamos.indexOf(jamos[initialIdx]) : -1;
            let medial = medialIdx < jamos.length ? medialJamos.indexOf(jamos[medialIdx]) : -1;
            let final = finalIdx < jamos.length ? finalJamos.indexOf(jamos[finalIdx]) : -1;
            const syllable = composeHangulSyllable(initial, medial, final);
            document.getElementById('hangulInput').value = syllable;
        }
    }
});
</script>

</body>
</html>